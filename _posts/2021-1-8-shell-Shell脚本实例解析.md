---
title: Shell编程学习-Shell脚本实例解析
date: 2021-1-8 23:29:53
categories:
- Shell
tags:
- Shell
---

## 1、变量

### 1.1、环境变量

   所有shell都可以使用全局变量或环境变量，使用**env**命令或**printenv**命令显示环境变量。

### 1.2、局部变量

局部变量只能用于**当前**shell。直接运行set内置命令时，显示包括环境变量的所有变量和函数目录。

### 1.3、生成变量

生成时默认使用大写字母，局部变量可使用小写字母，但为了防止混淆，最好使用大写字母。**变量可以包括数字，但是不能以数字开始。**使用unset命令删除生成的变量。

![]({{ site.url }}/assets/img/shell/1.1.png)


### 1.4、局部变量转为环境变量

在当前shell中生成的变量只能在当前shell中使用，即局部变量。只有将该局部变量转为环境变量，才能由**子进程**使用。**此时使用的命令时export内置命令，使用该命令可以将局部变量转为环境变量**。

 子shell能更改从父shell继承的变量，但子shell的修改不会影响父shell。

### 1.5、Shell字符串

```shell
str='this is a string'
```

单引号字符串的限制：

- 单引号里的任何字符都会原样输出，单引号字符串中的**变量是无效**的；

- 单引号字串中不能出现单独一个的单引号（对单引号使用转义符后也不行），但可成对出现，作为字符串拼接使用。

```shell
your_name='runoob'
str="Hello, I know you are \"$your_name\"! \n"
echo -e $str
```

双引号的优点：

- 双引号里可以有变量
- 双引号里可以出现转义字符

### 1.6、数组

bash支持一维数组（不支持多维数组），并且没有限定数组的大小。

```shell
//定义数组
array_name=(value0 value1 value2 value3)


//单独定义数组，下标不一定连续
array_name[0]=value0
array_name[1]=value1
array_name[n]=valuen

//读取数组
valuen=${array_name[n]}

//使用@符号可以获取数组中的所有元素
echo ${array_name[@]}
```


## 2、Boume Shell

### 2.1、运算符

算术运算符

| 运算符 |                     说明                      |             举例              |
| :----: | :-------------------------------------------: | :---------------------------: |
|   +    |                     加法                      |  `expr $a + $b` 结果为 30。   |
|   -    |                     减法                      |  `expr $a - $b` 结果为 -10。  |
|   *    |                     乘法                      | `expr $a \* $b` 结果为  200。 |
|   /    |                     除法                      |   `expr $b / $a` 结果为 2。   |
|   %    |                     取余                      |   `expr $b % $a` 结果为 0。   |
|   =    |                     赋值                      | a=$b 将把变量 b 的值赋给 a。  |
|   ==   |   相等。用于比较两个数字，相同则返回 true。   |   [ $a == $b ] 返回 false。   |
|   !=   | 不相等。用于比较两个数字，不相同则返回 true。 |   [ $a != $b ] 返回 true。    |

**关系运算符只支持数字，不支持字符串，除非字符串的值是数字。**

| 运算符 |                         说明                          |            举例            |
| :----: | :---------------------------------------------------: | :------------------------: |
|  -eq   |          检测两个数是否相等，相等返回 true。          | [ $a -eq $b ] 返回 false。 |
|  -ne   |        检测两个数是否不相等，不相等返回 true。        | [ $a -ne $b ] 返回 true。  |
|  -gt   |   检测左边的数是否大于右边的，如果是，则返回 true。   | [ $a -gt $b ] 返回 false。 |
|  -lt   |   检测左边的数是否小于右边的，如果是，则返回 true。   | [ $a -lt $b ] 返回 true。  |
|  -ge   | 检测左边的数是否大于等于右边的，如果是，则返回 true。 | [ $a -ge $b ] 返回 false。 |
|  -le   | 检测左边的数是否小于等于右边的，如果是，则返回 true。 | [ $a -le $b ] 返回 true。  |

布尔运算符

| 运算符 |                        说明                         |                   举例                   |
| :----: | :-------------------------------------------------: | :--------------------------------------: |
|   !    | 非运算，表达式为 true 则返回 false，否则返回 true。 |         [ ! false ] 返回 true。          |
|   -o   |      或运算，有一个表达式为 true 则返回 true。      | [ $a -lt 20 -o $b -gt 100 ] 返回 true。  |
|   -a   |      与运算，两个表达式都为 true 才返回 true。      | [ $a -lt 20 -a $b -gt 100 ] 返回 false。 |

逻辑运算符

| 运算符 |    说明    |                    举例                    |
| :----: | :--------: | :----------------------------------------: |
|   &&   | 逻辑的 AND | [[ $a -lt 100 && $b -gt 100 ]] 返回 false  |
|  \|\|  | 逻辑的 OR  | [[ $a -lt 100 \|\| $b -gt 100 ]] 返回 true |

字符串运算符

| 运算符 |                   说明                    |           举例           |
| :----: | :---------------------------------------: | :----------------------: |
|   =    |  检测两个字符串是否相等，相等返回 true。  | [ $a = $b ] 返回 false。 |
|   !=   | 检测两个字符串是否相等，不相等返回 true。 | [ $a != $b ] 返回 true。 |
|   -z   |   检测字符串长度是否为0，为0返回 true。   |  [ -z $a ] 返回 false。  |
|   -n   |  检测字符串长度是否为0，不为0返回 true。  | [ -n "$a" ] 返回 true。  |
|   $    |   检测字符串是否为空，不为空返回 true。   |    [ $a ] 返回 true。    |

###  2.2、条件语句

```shell
//单分支条件语句
if [条件判断式]      
then
程序
fi

//双分支条件语句
if [条件判断式]
then
当条件判断式成立时，执行的程序
else
当条件判断式不成立时，执行的另一个程序
fi

//多分支条件语句
if[条件判断式1]
then
当条件判断式1成立时，执行程序1
elif [条件判断式2]
then
当条件判断式2成立时，执行程序2
…省略更多条件...
else
当所有条件都不成立时，最后执行此程序、
fi
```

### 2.3、循环语句

#### 2.3.1、for循环

```shell
for var in item1 item2 ... itemN
do
    command1
    command2
    ...
    commandN
done

for loop in 1 2 3 4 5
do
    echo "The value is: $loop"
done
```

#### 2.3.2、while循环

```shell
while condition
do
    command
done

#!/bin/bash
int=1
while(( $int<=5 ))
do
    echo $int
    let "int++"
done
```

### 2.3.3 until循环

```shell
until condition
do
    command
done

#!/bin/bash

a=0

until [ ! $a -lt 10 ]
do
   echo $a
   a=`expr $a + 1`
done
```

#### 2.3.4、case语句

取值将检测匹配的每一个模式。一旦模式匹配，则执行完匹配模式相应命令后不再继续其他模式。如果无一匹配模式，使用星号 * 捕获该值，再执行后面的命令。

```shell
case 值 in
模式1)
    command1
    command2
    ...
    commandN
    ;;
模式2）
    command1
    command2
    ...
    commandN
    ;;
esac

echo '输入 1 到 4 之间的数字:'
echo '你输入的数字为:'
read aNum
case $aNum in
    1)  echo '你选择了 1'
    ;;
    2)  echo '你选择了 2'
    ;;
    3)  echo '你选择了 3'
    ;;
    4)  echo '你选择了 4'
    ;;
    *)  echo '你没有输入 1 到 4 之间的数字'
    ;;
esac
```

